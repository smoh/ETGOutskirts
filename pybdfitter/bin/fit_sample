#!/usr/bin/env python
""" wrapper for running fit_sample.pro """

import argparse
import datetime

from pybdfitter.fitter import fit_sample

parser = argparse.ArgumentParser(description='run fit_sample on input file')
parser.add_argument('input',
                        help='input fits table')
parser.add_argument('profile', type=str,
                        help='[profile name]:[number of params] e.g., SER:8')
parser.add_argument('start', type=int,
                        help='zero-based starting index')
parser.add_argument('end', type=int,
                        help='zero-based end index (inclusive)')
parser.add_argument('outdir',
                        help='output directory')
parser.add_argument('datadir',
                        help='data directory')
parser.add_argument('-f', '--filter', type=str, default='r',
                        help='filter to fit')
parser.add_argument('-r', '--res', action='store_true',
                        help='store model images')
parser.add_argument('-d', '--debug', action='store_true',
                        help='run in debug mode')
parser.add_argument('-i', '--imgdir', type=str,
                        help='image directory')
args = parser.parse_args()


print datetime.datetime.now()

out = fit_sample(
    args.input, args.profile, args.start, args.end, args.outdir,
    datadir=args.datadir, imgdir=args.imgdir, filter=args.filter,
    residual=args.res, debug=args.debug)
